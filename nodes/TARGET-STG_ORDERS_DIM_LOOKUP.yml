fileVersion: 1
id: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
name: STG_ORDERS_DIM_LOOKUP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42b91258-4e61-467d-97c0-0f3a9d9e0d40
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_DETAIL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 514c31b5-d1a4-4fcc-b8ad-d690117869b4
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d50a1df-35fa-4fbd-962c-e9ce9f2d13f1
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5489a838-bf58-4d56-96ca-5eae96e6976d
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ff49844-70ba-4220-a3a9-64be4d61bb58
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a7971bf-3b70-4331-9761-7d2d9cbed8a2
                stepCounter: 3acceba8-dbe0-4ffa-9f6a-480488e0380e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a738980-b03d-4fc8-aba1-4d97dc0acdb4
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_LOCATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d15a3c1-456e-414e-9aed-6bbadd297e09
                stepCounter: d5da52f1-33b4-4363-8942-1988e5d402c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 719b54f7-bae8-4263-ba55-b5e9af34fdcb
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_MENU_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06a0f1be-576a-496c-a8a3-581a726aa1d8
                stepCounter: e66c962f-1a29-40f4-a988-407746b350f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79393e32-74d3-40bd-a5d6-ab8a888d5ee0
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_TRUCK_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 667cb771-632e-4f1f-9177-435b436d0634
                stepCounter: 8aed29f4-c416-465e-9a2c-e08529f37a0c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1135d9b-5c6e-4c15-86e5-75e4fc30519a
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: MENU_ITEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce67c5a1-2b38-47d1-a897-a4214311511e
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f1f669-6034-498c-92af-97b45d06cc0a
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DISCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cecaccd-cd40-4ff4-816e-925bf4133f2a
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7f982b1-a4bd-4cf7-b4bf-fb6a662c9bca
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f4b974e-2ab4-42ed-81ae-4f45d7386342
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c3a78df-5a43-4bc8-b9f2-940997ce0e16
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(5,0)
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce81da6d-e206-49c0-ac65-554ed0fa7baa
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e877a4-b5c0-4dcf-aa63-ab5284bc343d
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: UNIT_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb8d18b-d41f-42d5-81fa-801531e79cdb
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8b423e3-6bf9-49d2-9034-3c3bd01e2165
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd610937-67db-4ac0-8284-11d4b8633ffe
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e238d4fe-f5bb-4b0d-9cc1-7b6c645e5bc6
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_ITEM_DISCOUNT_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68be2a05-5b5c-4bd8-8842-f9597b2176c7
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48bf1f94-8c3c-4188-b4dd-b80585e7f231
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TRUCK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ff2b2c5-70d9-49a6-91a6-f2566b675a72
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dafec145-53ca-4fe7-94b6-cdbb7c6dc191
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: FLOAT
        description: ""
        name: LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e355833b-627d-49de-b436-9b6d7c2c791a
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02df77a0-86b5-4ee1-9487-c366f51b858a
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474b34bd-abc5-4982-bf16-b5c5cded5d35
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c14c5b2-f447-42ef-b200-ffe8156553bf
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SHIFT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 477ca57d-d219-4677-9193-5d1c9997bd70
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43b0615-8119-4142-9444-6eb57ac04277
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: TIME(9)
        description: ""
        name: SHIFT_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c2414f0-ce94-483f-ba97-18dacbb2d7b5
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c121fb-a817-4ec1-9428-ee247c8a569c
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: TIME(9)
        description: ""
        name: SHIFT_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01256e86-b8fc-4335-be6f-1a3b0fe7c21d
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bc4e540-79b1-4fc1-8b9c-38b91a5dafa6
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_CHANNEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f5de605-f937-4a7c-b965-a251bd6213b5
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc76054-152b-472b-96c4-b111ec6b3527
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ORDER_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790babc3-c227-44b5-a091-bb83abddacb1
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20228b65-f337-4eb1-94a6-48ad1a6277e4
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: SERVED_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd1d81be-a0f5-4049-aeb9-9570b3f17269
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f44c2991-1882-4424-803f-ddbf7f4b1ea2
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(3)
        description: ""
        name: ORDER_CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8821c64b-95e6-4e2d-818f-733d0bc1a8c0
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7937702e-bdce-4ce4-8265-e05afd63c817
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: ORDER_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc3ce32a-f6bf-4fd0-9710-94f216f90c2e
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f20b2f6e-224d-4e95-8aca-b74e99c158ef
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_TAX_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e70cec2e-e6d3-4f12-9635-91db66d08dc7
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508c24a0-f035-49b4-95eb-34af6b3eca98
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_DISCOUNT_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3675f403-aaad-445c-b036-c5e17b8b2f80
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c2903a4-5a7e-4dd1-a021-fa28c38c00c2
          stepCounter: 6aea9f34-21e8-4cd3-a2d7-74fbba695b65
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: ORDER_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70560c43-82e4-438c-ac20-4b1328fe4a0e
                stepCounter: 2abf9293-6bf3-4434-9ac8-551c4c5945be
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_CUSTOMER: 3acceba8-dbe0-4ffa-9f6a-480488e0380e
          DIM_LOCATION: d5da52f1-33b4-4363-8942-1988e5d402c1
          DIM_MENU: e66c962f-1a29-40f4-a988-407746b350f9
          DIM_TRUCK: 8aed29f4-c416-465e-9a2c-e08529f37a0c
          STG_ORDERS: 2abf9293-6bf3-4434-9ac8-551c4c5945be
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_CUSTOMER
          - locationName: TARGET
            nodeName: DIM_LOCATION
          - locationName: TARGET
            nodeName: DIM_MENU
          - locationName: TARGET
            nodeName: DIM_TRUCK
          - locationName: TARGET
            nodeName: STG_ORDERS
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'STG_ORDERS') }} "STG_ORDERS"
            LEFT JOIN {{ ref('TARGET', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
            ON "STG_ORDERS"."CUSTOMER_ID" = "DIM_CUSTOMER"."CUSTOMER_ID"
            LEFT JOIN {{ ref('TARGET', 'DIM_LOCATION') }} "DIM_LOCATION"
            ON "STG_ORDERS"."LOCATION_ID" = "DIM_LOCATION"."LOCATION_ID"
            LEFT JOIN {{ ref('TARGET', 'DIM_MENU') }} "DIM_MENU"
            ON "STG_ORDERS"."MENU_ITEM_ID" = "DIM_MENU"."MENU_ITEM_ID"
            LEFT JOIN {{ ref('TARGET', 'DIM_TRUCK') }} "DIM_TRUCK"
            ON "STG_ORDERS"."TRUCK_ID" = "DIM_TRUCK"."TRUCK_ID"
        name: STG_ORDERS_DIM_LOOKUP
        noLinkRefs: []
  name: STG_ORDERS_DIM_LOOKUP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
